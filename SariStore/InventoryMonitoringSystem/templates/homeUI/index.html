{% extends "homeUI/layout.html" %} 

{% block content %}

<div class="container mt-3 mx-5 my-md-4 my-lg-4 my-xl-4 my-xxl-4">
    <h1 class="text-custom-dark-grey"><i class="bi bi-clipboard-data"></i> Dashboard Overview</h1>
    <p class="text-custom-dark-grey" id="date"></p>
    <script>
    setInterval(function() {
        const now = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
        const formattedDate = now.toLocaleDateString('en-US', options);
        document.getElementById('date').textContent = formattedDate;
    }, 1000);
</script>
</div>
<div class="container text-center mb-3">
  <div class="row">
    <div class="col-12 col-md-6 col-lg-3 px-5 px-md-2 px-lg-2 px-xl-3 px-xxl-4 py-3">
      <div class="card shadow rounded-4">
        <div class="card-header text-start bg-custom-teal text-light rounded-top-4 border-0"><i class="bi bi-diagram-3-fill"></i> Total Items</div>
        <div class="card-body">
          <figure>
            <blockquote class="blockquote">
              <p class="fs-2">{{ totalItems }}</p>
            </blockquote>
            <figcaption class="blockquote-footer">
              All products in <cite title="Source Title">Inventory</cite>
            </figcaption>
          </figure>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-3 px-5 px-md-2 px-lg-2 px-xl-3 px-xxl-4 py-3">
      <div class="card shadow rounded-4">
        <div class="card-header text-start bg-custom-pink text-light rounded-top-4 border-0"><i class="bi bi-cash-coin"></i> Number of sales</div>
        <div class="card-body">
          <figure>
            <blockquote class="blockquote">
              <p class="fs-2">â‚± {{ sales }}</p>
            </blockquote>
            <figcaption class="blockquote-footer">
              Transactions processed
            </figcaption>
          </figure>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-3 px-5 px-md-2 px-lg-2 px-xl-3 px-xxl-4 py-3">
      <div class="card shadow rounded-4">
        <div class="card-header text-start bg-custom-yellow text-light rounded-top-4 border-0"><i class="bi bi-star-fill"></i> Hit items</div>
        <div class="card-body">
          <figure>
            <blockquote class="blockquote">
              <p class="fs-2">{{ hitItems }}</p>
            </blockquote>
            <figcaption class="blockquote-footer">
              Top selling items
            </figcaption>
          </figure>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-3 px-5 px-md-2 px-lg-2 px-xl-3 px-xxl-4 py-3">
      <div class="card shadow rounded-4">
        <div class="card-header text-start bg-custom-blue text-light rounded-top-4 border-0"><i class="bi bi-person-fill-up"></i> Number of customers</div>
        <div class="card-body">
          <figure>
            <blockquote class="blockquote">
              <p class="fs-2">{{ totalCustomers }}</p>
            </blockquote>
            <figcaption class="blockquote-footer">
              Registered <cite title="Source Title">Customers</cite>
            </figcaption>
          </figure>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block analytics %}
<div class="container my-4">
    <div class="row g-4">
        <div class="col-12 col-lg-8">
            <div class="card shadow rounded-4 h-100 px-2 py-2">
                <div class="card-header bg-white border-0 pt-3">
                    <h5 class="mb-0">Sales Overview</h5>
                </div>
                <div class="card-body p-3">
                    <canvas id="firstChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-12 col-lg-4">
            <div class="card shadow rounded-4 h-100 px-2 py-2">
                <div class="card-header bg-white border-0 pt-3">
                    <h5 class="mb-0">Category Breakdown</h5>
                </div>
                <div class="card-body p-3 d-flex align-items-center">
                    <canvas id="secondChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-12">
            <div class="card shadow rounded-4 px-2 py-2">
                <div class="card-header bg-white border-0 pt-3">
                    <h5 class="mb-0">Weekly Sales Trend</h5>
                </div>
                <div class="card-body p-3">
                    <canvas id="thirdChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Bar Chart
  const ctx = document.getElementById('firstChart').getContext('2d');
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: {{ sales_labels|safe }},
      datasets: [{
        label: 'Sales',
        data: {{ sales_data|safe }},
        borderWidth: 1,
        backgroundColor: 'rgba(54, 162, 235, 0.6)',
        borderColor: 'rgba(54, 162, 235, 1)'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: { beginAtZero: true }
      },
      plugins: {
        legend: {
          display: false
        }
      }
    }
  });

  // Doughnut Chart
  const ctx2 = document.getElementById('secondChart').getContext('2d');
  new Chart(ctx2, {
    type: 'doughnut',
    data: {
      labels: {{ category_labels|safe }},
      datasets: [{
        label: 'Categories',
        data: {{ category_data|safe }},
        borderWidth: 1,
        backgroundColor: [
          'rgba(255, 99, 132, 0.7)',
          'rgba(255, 206, 86, 0.7)',
          'rgba(75, 192, 192, 0.7)',
          'rgba(153, 102, 255, 0.7)',
          'rgba(255, 159, 64, 0.7)'
        ]
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'top',
        }
      }
    }
  });

  // Line Chart (Updated for Weekly Data)
  const ctx3 = document.getElementById('thirdChart').getContext('2d');
  new Chart(ctx3, {
    type: 'line',
    data: {
      labels: {{ weekly_sales_labels|safe }},
      datasets: [{
        label: 'Total Weekly Sales',
        data: {{ weekly_sales_data|safe }},
        fill: true,
        backgroundColor: 'rgba(75, 192, 192, 0.2)',
        borderColor: 'rgba(75, 192, 192, 1)',
        tension: 0.2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: { beginAtZero: true }
      },
      plugins: {
        legend: {
          display: false
        }
      }
    }
  });
</script>
{% endblock %}
